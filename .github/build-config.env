# Ultimate 386BSD Build System Configuration
# Comprehensive build orchestration settings

# ==================== BUILD ENVIRONMENT ====================
BUILD_ARCH=i386
BUILD_MACHINE=i386
BUILD_OPTIMIZATION="-O1"
BUILD_WARNINGS="-Wall -Wno-endif-labels"

# Cross-compilation settings for modern hosts
CROSS_COMPILE_FLAGS="-m32"
CROSS_ASSEMBLE_FLAGS="--32"
CROSS_LINK_FLAGS="-m elf_i386"

# ==================== COMPILER CONFIGURATION ====================
# Legacy C89 compatibility
CC_STANDARD="-std=c89"
CC_DEFINES="-DKERNEL -Di486 -DCOMPAT_43 -DKTRACE -DDDB"
CC_INCLUDES="-I./include -I./include/dev -I./include/ic -I./include/fs -I./include/domain"

# ==================== BUILD STAGES ====================
# Stage 1: Environment validation
STAGE1_TIMEOUT=60
STAGE1_DEPS="build-essential bmake flex bison gcc-multilib"

# Stage 2: Dependency generation  
STAGE2_TIMEOUT=300
STAGE2_TARGET="depend"

# Stage 3: Compilation
STAGE3_TIMEOUT=900
STAGE3_TARGET="all"

# ==================== VALIDATION CRITERIA ====================
# Success criteria for each stage
CLEAN_SUCCESS_PATTERN="rm -f.*\\.(o|kerno|devo|fso|neto)"
DEPEND_SUCCESS_PATTERN="genassym"
BUILD_SUCCESS_PATTERN="386bsd"

# ==================== ERROR PATTERNS ====================
# Critical error patterns to detect
CRITICAL_ERRORS=(
    "fatal error:"
    "No such file or directory"
    "undefined reference"
    "multiple definition"
    "syntax error"
)

# Warning patterns to monitor
WARNING_PATTERNS=(
    "warning:"
    "extra tokens at end"
    "conflicting types"
    "format '%d' expects"
)

# ==================== ARTIFACT COLLECTION ====================
# Build artifacts to preserve
BUILD_ARTIFACTS=(
    "*.o"
    "*.log"
    "genassym"
    "assym.s"
    "386bsd*"
    ".depend"
)

# Log files to analyze
LOG_FILES=(
    "build-clean.log"
    "build-depend.log" 
    "build-compile.log"
    "error-analysis.log"
)

# ==================== PERFORMANCE METRICS ====================
# Build performance targets
MAX_CLEAN_TIME=60
MAX_DEPEND_TIME=300
MAX_BUILD_TIME=900

# Resource limits
MAX_MEMORY_MB=2048
MAX_DISK_MB=1024

# ==================== COMPATIBILITY MATRIX ====================
# Supported configurations
SUPPORTED_ARCHS="i386"
SUPPORTED_CONFIGS="stock small odysseus"
SUPPORTED_OPTIMIZATIONS="-O0 -O1 -O2"
SUPPORTED_COMPILERS="gcc"

# ==================== DIAGNOSTICS ====================
# Diagnostic checks to perform
DIAGNOSTIC_CHECKS=(
    "check_bmake_version"
    "check_gcc_multilib" 
    "check_assembler_syntax"
    "check_linker_support"
    "validate_headers"
    "verify_includes"
)

# ==================== ORCHESTRATION SETTINGS ====================
# CI/CD pipeline configuration
PIPELINE_PARALLEL_JOBS=4
PIPELINE_ARTIFACT_RETENTION=30
PIPELINE_CACHE_ENABLED=true
PIPELINE_MATRIX_STRATEGY="fail-fast=false"

# Notification settings
NOTIFY_ON_SUCCESS=true
NOTIFY_ON_FAILURE=true
NOTIFY_INCLUDE_LOGS=true

# ==================== ADVANCED FEATURES ====================
# Incremental build support
INCREMENTAL_BUILD_ENABLED=false
CCACHE_ENABLED=false
DISTCC_ENABLED=false

# Analysis and profiling
PROFILE_BUILD_TIME=true
ANALYZE_DEPENDENCIES=true
GENERATE_REPORTS=true
VALIDATE_REPRODUCIBILITY=false

# ==================== LEGACY COMPATIBILITY ====================
# Original 386BSD compatibility settings
ORIGINAL_MAKEFILE_COMPAT=true
BSD_MAKE_BEHAVIOR=true
LEGACY_ASSEMBLER_SYNTAX=true
TRADITIONAL_INCLUDES=true

# Modern adaptations
MODERN_COMPILER_WARNINGS=false
GNU_ASSEMBLER_COMPAT=true
UBUNTU_2404_FIXES=true
HEADER_DEPENDENCY_FIXES=true

# ==================== TROUBLESHOOTING ====================
# Debug and troubleshooting options
DEBUG_BUILD_SYSTEM=false
VERBOSE_MAKEFILE_OUTPUT=false
PRESERVE_TEMP_FILES=false
DETAILED_ERROR_ANALYSIS=true

# Recovery options
AUTO_RETRY_FAILED_BUILDS=false
FALLBACK_TO_MANUAL_CONFIG=false
GENERATE_MINIMAL_CONFIG=false

# ==================== REPORTING ====================
# Report generation settings
GENERATE_HTML_REPORT=false
GENERATE_MARKDOWN_REPORT=true
INCLUDE_BUILD_METRICS=true
INCLUDE_ERROR_ANALYSIS=true
INCLUDE_PERFORMANCE_DATA=true

# Report format options
REPORT_DETAIL_LEVEL="comprehensive"
REPORT_INCLUDE_GRAPHS=false
REPORT_EXPORT_FORMAT="markdown"